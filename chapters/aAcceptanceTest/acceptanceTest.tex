\chapter{Acceptance Test}

The system has been investigated and described in Part I through the modeling and the analysis. A proper controller and a solution to avoid the use of external sensors have been designed in Part II.

This chapter deals with the needed tests that the system must overcome in order to fulfill the requirements as well as an analysis of the other capabilities, described in \chapref{chap:specifications}.

\section{Requirements}

- \textbf{The Cubli should be able to balance starting from an unstable equilibrium position and a null velocity.}

To test this requirement the Cubli is placed at equilibrium and the controller is then started. The test is done twice, with the measurements of the potentiometer and the IMU, to ensure that the controller works in both cases.
%
\begin{minipage}{\linewidth}
	\begin{minipage}{0.45\linewidth}
		\begin{figure}[H]
			\includegraphics[scale=.45]{figures/testReq1}
			\centering
			\captionsetup{justification=centering}
			\captionof{figure}{Angular position of the frame, measured with the potentiometer, when starting from equilibrium position}
			\label{testReq1}
		\end{figure}
	\end{minipage}
	\hspace{0.03\linewidth}
	\begin{minipage}{0.45\linewidth}
		\begin{figure}[H]\vspace{0mm}
			\includegraphics[scale=.45]{figures/testReq1_IMU}
			\centering
			\captionsetup{justification=centering}
			\captionof{figure}{Angular position of the frame starting from equilibrium position, calculated with the complementary filter}
			\label{testReq1_IMU}
		\end{figure}
	\end{minipage}
\end{minipage}
%

The results show that the requirement is fulfilled in both cases since the system is maintained around the equilibrium position.

- \textbf{The prototype should be able to balance around \si{0\ \rad} regardless of the level of the baseplate, using internally mounted sensors.}

To check this requirement a similar test is done, but is this case the angle of the base plate is change to check that the measurements of the IMU are  still capable of balance the Cubli.
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.65]{figures/testReq2}
	\caption{Angular position of the frame. The red curve is the result of the complementary filter, which does not depend on the angle of the base, while the blue one shows the measurements of the potentiometer}
	\label{testReq2}
\end{figure}\vspace{-5mm}
%
The output of this experiment shows that the calculation of the position using the IMU makes the system able to keep in equilibrium position when the angle is changed.


\section{Capabilities Analysis}
- \textbf{Maximum recovery angle}

To obtain the maximum recovery angle, the Cubli is place in equilibrium at the start. Once the controller has balance it, its position is changed with little disturbances. The result can be seen in \figref{testRecovery}.
%
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.65]{figures/testRecovery}
	\caption{}
	\label{testRecovery}
\end{figure}\vspace{-5mm}
%
As it can be observed, the controller is able to return to equilibrium position but it creates a remarkable overshoot in the other direction. This behavior limits the recovery angle since the overshoot may drive the Cubli to an angle beyond its handling limit even though the initial disturbance is within it.\\
It can be seen that the controller is capable of recovering from \si{0,08\ rad} but it fails when the angle is \si{0,1\ rad}. Then, it can be concluded that the maximum recovery angle for the system with the designed controller is \si{0,08\ rad}.

- \textbf{Maximum catching angle with no initial velocity of the wheel}

There exists a limitation in this capability which is given by the maximum current that the motor can provide. As can be seen in \figref{limitationTorque}, if the initial angle is different from 0 rad both the mass of the frame ans the mass of the wheel exert an initial torque to the system. This must be overcame by the motor to avoid the Cubli to fall.
%
\begin{figure}[H] 
	\centering
	\includegraphics[scale=0.65]{figures/limitationTorque}
	\caption{Force acting on the system that create an initial torque}
	\label{limitationTorque}
\end{figure}

The minimum torque that the motor must apply is give by \eqref{minTorque}.
%
\begin{flalign}
	\eq{T} { (m_F \cdot l_F + m_w \cdot l_w) \cdot g \cdot sin(\theta_F)} \unit{N\cdot m}
	\label{minTorque}
\end{flalign}

Since the torque is restricted by the characteristics of the motor and the control board, the maximum initial angle is derived in \eqref{maxAngle}.
%
\begin{flalign}
	\eq{\theta_F} { asin\left(\frac{T}{(m_F \cdot l_F + m_w \cdot l_w) \cdot g}\right)} \unit{N\cdot m}
	\label{maxAngle}
\end{flalign}
%
Substituting the values of the maximum torque (see section \ref{sec:Motor}) and the parameters of the Cubli (see section \ref{sec:Param}) the maximum possible starting angle is \si{0,2024\ rad}.

